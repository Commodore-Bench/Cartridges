;
; File generated by cc65 v 2.18 - Git 947dd9a
;
	.fopt		compiler,"cc65 v 2.18 - Git 947dd9a"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	off
	.importzp	sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.import		_ef3usb_send_data
	.export		_ef3usb_receive_byte
	.export		_ef3usb_send_byte
	.export		_kff_send_command
	.export		_kff_send_ext_command

.segment	"DATA"

_cmd_buf:
	.byte	$4B,$46,$46,$3A,$00,$00,$00

; ---------------------------------------------------------------
; unsigned char __near__ ef3usb_receive_byte (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_ef3usb_receive_byte: near

.segment	"CODE"

;
; while (!(USB_STATUS & USB_RX_READY));
;
L0005:	lda     $DE09
	and     #$80
	beq     L0005
;
; return USB_DATA;
;
	ldx     #$00
	lda     $DE0A
;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ ef3usb_send_byte (unsigned char data)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_ef3usb_send_byte: near

.segment	"CODE"

;
; {
;
	jsr     pusha
;
; while (!(USB_STATUS & USB_TX_READY));
;
L0005:	lda     $DE09
	and     #$40
	beq     L0005
;
; USB_DATA = data;
;
	ldy     #$00
	lda     (sp),y
	sta     $DE0A
;
; }
;
	jmp     incsp1

.endproc

; ---------------------------------------------------------------
; unsigned char __near__ kff_send_command (unsigned char cmd)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_kff_send_command: near

.segment	"CODE"

;
; {
;
	jsr     pusha
;
; cmd_buf[4] = cmd;
;
	ldy     #$00
	lda     (sp),y
	sta     _cmd_buf+4
;
; ef3usb_send_data(cmd_buf, 5);
;
	lda     #<(_cmd_buf)
	ldx     #>(_cmd_buf)
	jsr     pushax
	ldx     #$00
	lda     #$05
	jsr     _ef3usb_send_data
;
; return ef3usb_receive_byte();
;
	jsr     _ef3usb_receive_byte
;
; }
;
	jmp     incsp1

.endproc

; ---------------------------------------------------------------
; unsigned char __near__ kff_send_ext_command (unsigned char cmd, unsigned char data)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_kff_send_ext_command: near

.segment	"CODE"

;
; {
;
	jsr     pusha
;
; cmd_buf[4] = cmd;
;
	ldy     #$01
	lda     (sp),y
	sta     _cmd_buf+4
;
; cmd_buf[5] = data;
;
	dey
	lda     (sp),y
	sta     _cmd_buf+5
;
; ef3usb_send_data(cmd_buf, 6);
;
	lda     #<(_cmd_buf)
	ldx     #>(_cmd_buf)
	jsr     pushax
	ldx     #$00
	lda     #$06
	jsr     _ef3usb_send_data
;
; return ef3usb_receive_byte();
;
	jsr     _ef3usb_receive_byte
;
; }
;
	jmp     incsp2

.endproc

