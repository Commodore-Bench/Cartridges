Based on "Rev C" branch.
