Based on "Rev D" branch.
